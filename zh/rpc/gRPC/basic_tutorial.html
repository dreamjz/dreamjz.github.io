<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Basics tutorial | 今朝のブログ</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
    <link rel="shortcut icon" herf="favicon.ico">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-3RQ3LRSTKM"></script>
    <script>window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
		  
			gtag('config', 'G-3RQ3LRSTKM');</script>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="google-site-verification" content="lHBWOiWCnBWvc1h4REqjllalv9ZpQbXbHDdM8chFuuw">
    
    <link rel="preload" href="/assets/css/0.styles.af604b7b.css" as="style"><link rel="preload" href="/assets/js/app.35ae0727.js" as="script"><link rel="preload" href="/assets/js/6.af237152.js" as="script"><link rel="preload" href="/assets/js/1.44a00389.js" as="script"><link rel="preload" href="/assets/js/100.e98c1a94.js" as="script"><link rel="prefetch" href="/assets/js/10.2deab33d.js"><link rel="prefetch" href="/assets/js/101.3b124b5f.js"><link rel="prefetch" href="/assets/js/102.d8136b95.js"><link rel="prefetch" href="/assets/js/103.cc0ae299.js"><link rel="prefetch" href="/assets/js/104.f9224530.js"><link rel="prefetch" href="/assets/js/105.cf4e4bdc.js"><link rel="prefetch" href="/assets/js/106.f6de6afc.js"><link rel="prefetch" href="/assets/js/107.20ff0b05.js"><link rel="prefetch" href="/assets/js/108.01a5515e.js"><link rel="prefetch" href="/assets/js/109.69841539.js"><link rel="prefetch" href="/assets/js/11.6ad8e275.js"><link rel="prefetch" href="/assets/js/12.ebe6955f.js"><link rel="prefetch" href="/assets/js/13.1475d5b5.js"><link rel="prefetch" href="/assets/js/14.5e479794.js"><link rel="prefetch" href="/assets/js/15.af2cf359.js"><link rel="prefetch" href="/assets/js/16.d4fff34f.js"><link rel="prefetch" href="/assets/js/17.74bff51a.js"><link rel="prefetch" href="/assets/js/18.ed91f954.js"><link rel="prefetch" href="/assets/js/19.86a7ba1d.js"><link rel="prefetch" href="/assets/js/2.1c1078ee.js"><link rel="prefetch" href="/assets/js/20.e2589558.js"><link rel="prefetch" href="/assets/js/21.ffafb8e8.js"><link rel="prefetch" href="/assets/js/22.4ec79f50.js"><link rel="prefetch" href="/assets/js/23.f3438343.js"><link rel="prefetch" href="/assets/js/24.1f20e112.js"><link rel="prefetch" href="/assets/js/25.deb44a9c.js"><link rel="prefetch" href="/assets/js/26.c9f40697.js"><link rel="prefetch" href="/assets/js/27.dcf399c7.js"><link rel="prefetch" href="/assets/js/28.38ef51e6.js"><link rel="prefetch" href="/assets/js/29.551b1b44.js"><link rel="prefetch" href="/assets/js/30.a47b6792.js"><link rel="prefetch" href="/assets/js/31.f63696b0.js"><link rel="prefetch" href="/assets/js/32.bcc4aee5.js"><link rel="prefetch" href="/assets/js/33.4a22ca1e.js"><link rel="prefetch" href="/assets/js/34.9899e948.js"><link rel="prefetch" href="/assets/js/35.997f7e42.js"><link rel="prefetch" href="/assets/js/36.e4c69bde.js"><link rel="prefetch" href="/assets/js/37.f3a61195.js"><link rel="prefetch" href="/assets/js/38.561e7ec7.js"><link rel="prefetch" href="/assets/js/39.42a3d758.js"><link rel="prefetch" href="/assets/js/40.79bdb1be.js"><link rel="prefetch" href="/assets/js/41.a2ff04d8.js"><link rel="prefetch" href="/assets/js/42.c1b3c6a9.js"><link rel="prefetch" href="/assets/js/43.c9a24c6c.js"><link rel="prefetch" href="/assets/js/44.7206d672.js"><link rel="prefetch" href="/assets/js/45.1360c981.js"><link rel="prefetch" href="/assets/js/46.c539d8e0.js"><link rel="prefetch" href="/assets/js/47.61dbc5ea.js"><link rel="prefetch" href="/assets/js/48.fcebbb03.js"><link rel="prefetch" href="/assets/js/49.e34f9c8f.js"><link rel="prefetch" href="/assets/js/5.15fd78d1.js"><link rel="prefetch" href="/assets/js/50.30d28c91.js"><link rel="prefetch" href="/assets/js/51.cdf19830.js"><link rel="prefetch" href="/assets/js/52.51898f96.js"><link rel="prefetch" href="/assets/js/53.32d091fd.js"><link rel="prefetch" href="/assets/js/54.6ee8055d.js"><link rel="prefetch" href="/assets/js/55.da2dff2c.js"><link rel="prefetch" href="/assets/js/56.1982c440.js"><link rel="prefetch" href="/assets/js/57.ba1bd3bb.js"><link rel="prefetch" href="/assets/js/58.f120f334.js"><link rel="prefetch" href="/assets/js/59.456a951d.js"><link rel="prefetch" href="/assets/js/60.d0e3420e.js"><link rel="prefetch" href="/assets/js/61.77d9ffe3.js"><link rel="prefetch" href="/assets/js/62.b3c372ca.js"><link rel="prefetch" href="/assets/js/63.57902a13.js"><link rel="prefetch" href="/assets/js/64.f7d005e6.js"><link rel="prefetch" href="/assets/js/65.99f7fc78.js"><link rel="prefetch" href="/assets/js/66.afbc059e.js"><link rel="prefetch" href="/assets/js/67.e982be0e.js"><link rel="prefetch" href="/assets/js/68.afc753b9.js"><link rel="prefetch" href="/assets/js/69.d3a6a8c6.js"><link rel="prefetch" href="/assets/js/7.5ba40ed1.js"><link rel="prefetch" href="/assets/js/70.086ffef1.js"><link rel="prefetch" href="/assets/js/71.011366f2.js"><link rel="prefetch" href="/assets/js/72.20bf0590.js"><link rel="prefetch" href="/assets/js/73.dd303726.js"><link rel="prefetch" href="/assets/js/74.6b587967.js"><link rel="prefetch" href="/assets/js/75.b4a04ac4.js"><link rel="prefetch" href="/assets/js/76.aab6e073.js"><link rel="prefetch" href="/assets/js/77.f1458c86.js"><link rel="prefetch" href="/assets/js/78.b750ec54.js"><link rel="prefetch" href="/assets/js/79.24372947.js"><link rel="prefetch" href="/assets/js/8.716769a4.js"><link rel="prefetch" href="/assets/js/80.1b3677d0.js"><link rel="prefetch" href="/assets/js/81.c4831305.js"><link rel="prefetch" href="/assets/js/82.1e2f9c34.js"><link rel="prefetch" href="/assets/js/83.54137483.js"><link rel="prefetch" href="/assets/js/84.1f275cdf.js"><link rel="prefetch" href="/assets/js/85.88f053cc.js"><link rel="prefetch" href="/assets/js/86.1cdb6099.js"><link rel="prefetch" href="/assets/js/87.3bea4fb1.js"><link rel="prefetch" href="/assets/js/88.56682a60.js"><link rel="prefetch" href="/assets/js/89.a9d245ee.js"><link rel="prefetch" href="/assets/js/9.12d6a935.js"><link rel="prefetch" href="/assets/js/90.00f0a818.js"><link rel="prefetch" href="/assets/js/91.b128d13e.js"><link rel="prefetch" href="/assets/js/92.6167b0f4.js"><link rel="prefetch" href="/assets/js/93.14c843f7.js"><link rel="prefetch" href="/assets/js/94.d28886fb.js"><link rel="prefetch" href="/assets/js/95.ab9365cd.js"><link rel="prefetch" href="/assets/js/96.813d6c38.js"><link rel="prefetch" href="/assets/js/97.0de2ab4d.js"><link rel="prefetch" href="/assets/js/98.9022dabc.js"><link rel="prefetch" href="/assets/js/99.e4920114.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.f184c8e3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.af604b7b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-0f44a727><div data-v-0f44a727><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-0f44a727 data-v-0f44a727><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-355e03f9 data-v-0f44a727 data-v-0f44a727><h3 class="title" data-v-355e03f9 data-v-355e03f9>今朝のブログ</h3> <p class="description" data-v-355e03f9 data-v-355e03f9></p> <label id="box" class="inputBox" data-v-355e03f9 data-v-355e03f9><input type="password" value="" data-v-355e03f9> <span data-v-355e03f9>Konck! Knock!</span> <button data-v-355e03f9>OK</button></label> <div class="footer" data-v-355e03f9 data-v-355e03f9><span data-v-355e03f9><i class="iconfont reco-theme" data-v-355e03f9></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-355e03f9>vuePress-theme-reco</a></span> <span data-v-355e03f9><i class="iconfont reco-copyright" data-v-355e03f9></i> <a data-v-355e03f9><span data-v-355e03f9>今朝</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-0f44a727><header class="navbar" data-v-0f44a727><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/image/hero.jpg" alt="今朝のブログ" class="logo"> <span class="site-name">今朝のブログ</span></a> <div class="links"><!----> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh/index.html" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><a href="/reading-note/index.html" class="nav-link"><i class="iconfont reco-document"></i>
  Reading Note
</a></div><div class="nav-item"><a href="/lang/index.html" class="nav-link"><i class="iconfont reco-message"></i>
  Language
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/categories/golang/" class="nav-link"><i class="iconfont reco-category"></i>
  Category
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div><div class="nav-item"><a href="https://github.com/dreamjz" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-0f44a727></div> <aside class="sidebar" data-v-0f44a727><div class="personal-info-wrapper" data-v-5aaeb100 data-v-0f44a727><img src="/image/hero.jpg" alt="author-avatar" class="personal-img" data-v-5aaeb100> <h3 class="name" data-v-5aaeb100>
    今朝
  </h3> <div class="num" data-v-5aaeb100><div data-v-5aaeb100><h3 data-v-5aaeb100>82</h3> <h6 data-v-5aaeb100>文章</h6></div> <div data-v-5aaeb100><h3 data-v-5aaeb100>23</h3> <h6 data-v-5aaeb100>标签</h6></div></div> <ul class="social-links" data-v-5aaeb100></ul> <hr data-v-5aaeb100></div> <nav class="nav-links"><div class="nav-item"><a href="/zh/index.html" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><a href="/reading-note/index.html" class="nav-link"><i class="iconfont reco-document"></i>
  Reading Note
</a></div><div class="nav-item"><a href="/lang/index.html" class="nav-link"><i class="iconfont reco-message"></i>
  Language
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/categories/golang/" class="nav-link"><i class="iconfont reco-category"></i>
  Category
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tags
</a></div><div class="nav-item"><a href="https://github.com/dreamjz" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <ul class="sidebar-links"><li><a href="/zh/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/zh/retaining_computer_science_knowledge.html" class="sidebar-link">Retaining Computer Science Knowledge</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Golang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Leet Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>RPC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Raspberry Pi</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Front End</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-355e03f9 data-v-0f44a727><h3 class="title" data-v-355e03f9 data-v-355e03f9>Basics tutorial</h3> <!----> <label id="box" class="inputBox" data-v-355e03f9 data-v-355e03f9><input type="password" value="" data-v-355e03f9> <span data-v-355e03f9>Konck! Knock!</span> <button data-v-355e03f9>OK</button></label> <div class="footer" data-v-355e03f9 data-v-355e03f9><span data-v-355e03f9><i class="iconfont reco-theme" data-v-355e03f9></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-355e03f9>vuePress-theme-reco</a></span> <span data-v-355e03f9><i class="iconfont reco-copyright" data-v-355e03f9></i> <a data-v-355e03f9><span data-v-355e03f9>今朝</span>
            
          <!---->
          2022
        </a></span></div></div> <div data-v-0f44a727><div id="particles-js" color="#dedede" particleOpacity="0.7" linesColor="#dedede" particlesNumber="80" shapeType="circle" particleSize="4" linesWidth="1" lineLinked="true" lineOpacity="0.4" linesDistance="150" moveSpeed="3" hoverEffect="true" hoverMode="grab" clickEffect="true" clickMode="push" class="bg-particles"></div> <main class="page"><section><div class="page-title"><h1 class="title">Basics tutorial</h1> <div data-v-ff1aa866><i class="iconfont reco-account" data-v-ff1aa866><span data-v-ff1aa866>今朝</span></i> <i class="iconfont reco-date" data-v-ff1aa866><span data-v-ff1aa866>2021/12/30</span></i> <!----> <i class="tags iconfont reco-tag" data-v-ff1aa866><span class="tag-item" data-v-ff1aa866>grpc</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="_1-why-use-grpc"><a href="#_1-why-use-grpc" class="header-anchor">#</a> 1. Why use gRPC</h2> <p>The example is a simple route mapping application that lets clients get information about features on their route, create a summary of their route, and exchange route information such as traffic updates with the server and other clients.</p> <p>With gRPC we can define our service onec in a <code>.proto</code> file and generate clients and servers in any of gRPC’s supported languages, which in turn can be run in environments ranging from servers inside a large data center to your own tablet -- all the complexity of communication between different languages and environments is handled for you by gRPC. We also get all the advantages of working with protocol buffers, including efficient serialization, a simple IDL, and easy interface upadting.</p> <h2 id="_2-defining-the-service"><a href="#_2-defining-the-service" class="header-anchor">#</a> 2. Defining the service</h2> <p>To define a service, you specify a named <code>service</code> in your <code>.proto</code> file:</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token keyword">service</span> <span class="token class-name">RouteGuide</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Then you define <code>rpc</code> methods inside your service definition, specifying their request and response types. gRPC lets you define four kinds of service method, all of which are used in the <code>RouteGuide</code> service :</p> <ul><li><p>A simple RPC where the client sends a request to the server using the stub and waits for a response to come back, just like a normal function call.</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token comment">// Obtains the feature at a given position.</span>
<span class="token keyword">rpc</span> <span class="token function">GetFeature</span><span class="token punctuation">(</span><span class="token class-name">Point</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token class-name">Feature</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>A server-side streaming RPC where the client sends a request to the server and gets a stream to read a sequence of messages back. The client reads from the returned stream until there are no more messages. As you can see in the example, you specify a server-side streaming method by placing the <code>stream</code> keyword brefore the <em>response</em> type.</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token comment">// Obtains the Features available within the given Rectangle.</span>
<span class="token comment">// Results are streamed rather than returned at once (e.g.</span>
<span class="token comment">// in a response message with a repeated field), as the rectangle</span>
<span class="token comment">// may cover a large area and contain a huge number of features.</span>
<span class="token keyword">rpc</span> <span class="token function">ListFeatures</span><span class="token punctuation">(</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token keyword">stream</span> <span class="token class-name">Feature</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>A client-side streaming RPC where the client writes a sequence of messages and sends them to the server, again using a provided stream. Once the client has finished writing the message, it waits for the server to read them all and return its response. You specify a client-side streaming method by placing the <code>stream</code> keyword before the <em>request</em> type.</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token comment">// Accepts a stream of Points on a route being traversed, returning a </span>
<span class="token comment">// RouteSummary when traversal is completed.</span>
<span class="token keyword">rpc</span> <span class="token function">RecordRoute</span><span class="token punctuation">(</span><span class="token keyword">stream</span> <span class="token class-name">Point</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token class-name">RouteSummary</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>A bidirectional streaming RPC where both side send a sequence of messages using a read-write stream. The two streams operate independently, so clients and servers can read and write in whatever order they like: for example, the server could wait to receive all the client messages before writing its responses, or it could alternately read a message then write a message, or some other combination of reads and writes. The order of messages in each stream is preserved. You specify this type of method by placing the <code>stream</code> keyword before both the request and the response.</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token comment">// Accepts a stream of RouteNotes sent while a route is being traversed,</span>
<span class="token comment">// while receiving other RouteNotes (e.g. from other users)</span>
<span class="token keyword">rpc</span> <span class="token function">RouteChat</span><span class="token punctuation">(</span><span class="token keyword">stream</span> <span class="token class-name">RouteNote</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token punctuation">(</span><span class="token keyword">stream</span> <span class="token class-name">RouteNote</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <p>The <code>.proto</code> file also contains protocol buffer message type definitions for all the request and response types used in our service methods - for example, here’s the <code>Point</code> message type:</p> <div class="language-protobuf line-numbers-mode"><pre class="language-protobuf"><code><span class="token comment">// Points are represented as latitude-longitude pairs in the E7 representation</span>
<span class="token comment">// (degrees multiplied by 10**7 and rounded to the nearest integer).</span>
<span class="token comment">// Latitudes should be in the range +/- 90 degrees and longitude should be in</span>
<span class="token comment">// the range +/- 180 degrees (inclusive).</span>
<span class="token keyword">message</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token builtin">int32</span> latitude <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token builtin">int32</span> longitude <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_3-generating-client-and-server-code"><a href="#_3-generating-client-and-server-code" class="header-anchor">#</a> 3. Generating client and server code</h2> <p>From the <code>examples/route_guide</code> directory, run the following command:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ protoc --go_out<span class="token operator">=</span>. --go_opt<span class="token operator">=</span>paths<span class="token operator">=</span>source_relative <span class="token punctuation">\</span>
    --go-grpc_out<span class="token operator">=</span>. --go-grpc_opt<span class="token operator">=</span>paths<span class="token operator">=</span>source_relative <span class="token punctuation">\</span>
    routeguide/route_guide.proto
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Running this command generates the following files in the <code>routeguide</code> directory:</p> <ul><li><code>route_guide.pb.go</code>: which contains all the protocol buffer code to populate, serialize, and retrieve request and response message types.</li> <li><code>route_guide_grpc.pb.go</code>: which contains the following:
<ul><li>An interface type (or stub) for clients to call with the methods defined in the <code>RouteGuide</code> service.</li> <li>An interface type for servers to implement, also with the methods defined in the <code>RouteGuide</code> service.</li></ul></li></ul> <h2 id="_4-creating-the-server"><a href="#_4-creating-the-server" class="header-anchor">#</a> 4. Creating the server</h2> <p>There are two parts to making our <code>RouteGuide</code> service do its job:</p> <ul><li>Implementing the service interface generated from our service definition: doing the actual “work” of our service.</li> <li>Running a gRPC server to listen for request from clients and dispatch them to the right service implementation.</li></ul> <h3 id="_4-1-implementing-routeguide"><a href="#_4-1-implementing-routeguide" class="header-anchor">#</a> 4.1 Implementing RouteGuide</h3> <p>As you can see, our server has a <code>routeGuideServer</code>  struct type that implements the generated <code>RouteGuideServer</code> interface :</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> routeGuideServer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">GetFeature</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> point <span class="token operator">*</span>pb<span class="token punctuation">.</span>Point<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>pb<span class="token punctuation">.</span>Feature<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">ListFeatures</span><span class="token punctuation">(</span>rect <span class="token operator">*</span>pb<span class="token punctuation">.</span>Rectangle<span class="token punctuation">,</span> stream pb<span class="token punctuation">.</span>RouteGuide_ListFeaturesServer<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">RecordRoute</span><span class="token punctuation">(</span>stream pb<span class="token punctuation">.</span>RouteGuide_RecordRouteServer<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">RouteChat</span><span class="token punctuation">(</span>stream pb<span class="token punctuation">.</span>RouteGuide_RouteChatServer<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="_4-2-simple-rpc"><a href="#_4-2-simple-rpc" class="header-anchor">#</a> 4.2 Simple RPC</h3> <p>The <code>routeGuideServer</code> implements all our service methods. Let’s look at the simplest type first, <code>GetFeature</code>, which just gets a <code>Point</code> from the client and returns the corresponding feature information from its database in a <code>Feature</code>.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">GetFeature</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> point <span class="token operator">*</span>pb<span class="token punctuation">.</span>Point<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>pb<span class="token punctuation">.</span>Feature<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> feature <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>savedFeatures <span class="token punctuation">{</span>
        <span class="token keyword">if</span> proto<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>Location<span class="token punctuation">,</span> point<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> feature<span class="token punctuation">,</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// No feature was found, return an unnamed feature</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>pb<span class="token punctuation">.</span>Feature<span class="token punctuation">{</span>Location<span class="token punctuation">:</span> point<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The method is passed a context object for the RPC and the client’s <code>Point</code> protocol buffer request. It returns a <code>Feature</code> protocol buffer object with the response information and an <code>error</code>. In the method we populate the <code>Feature</code> with the appropriate information, and then return it along with an nil error to tell gRPC that we’ve finished dealing with the RPC and that the <code>Feature</code> can be returned to the client.</p> <h3 id="_4-3-server-side-streaming-rpc"><a href="#_4-3-server-side-streaming-rpc" class="header-anchor">#</a> 4.3 Server-side streaming RPC</h3> <p><code>ListFeatures</code> is a server-side streaming RPC, so need to send back multiple <code>Feature</code>s to our client.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">ListFeatures</span><span class="token punctuation">(</span>rect <span class="token operator">*</span>pb<span class="token punctuation">.</span>Rectangle<span class="token punctuation">,</span> stream pb<span class="token punctuation">.</span>RouteGuide_ListFeaturesServer<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>feature <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>saveFeatures <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token function">inRange</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>Location<span class="token punctuation">,</span>rect<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">;</span>err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            	<span class="token keyword">return</span> err
        	<span class="token punctuation">}</span>
       	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>As you can see, instead of getting simple request and response objects in our method parameters, this time we get a request object (the <code>Rectangle</code> in which our client wants to find <code>Feature</code>s) and a special <code>RouteGuide_ListFeaturesServer</code> object to write our responses.</p> <p>In the method, we populate as many <code>Feature</code> objects as we need to return, writing them to the <code>RouteGuide_ListFeaturesServer</code> using its <code>Send()</code> method. Finally, as in our simple RPC, we return a nil error to tell gRPC that we have finished writing responses. Should any error happen in this call, we return a non-nil error; the gRPC layer will translate it into an appropriate RPC status to be sent on the wire.</p> <h3 id="_4-4-client-side-streaming-rpc"><a href="#_4-4-client-side-streaming-rpc" class="header-anchor">#</a> 4.4 Client-side streaming RPC</h3> <p>The client-side streaming method <code>RecordRoute</code>, where we get a stream of <code>Point</code>s from the client and return a single <code>RouteSummary</code> with information about the trip. As you can see, this time the method doesn’t have a request parameter at all. Instead, it gets a <code>RouteGuide_RecordRouteServer</code> stream, which the server can use to both read <em>and</em> write messages - it can receive client messages using its <code>Recv()</code> method and return its single response using its <code>SendAndClose()</code> method :</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">RecordRoute</span><span class="token punctuation">(</span>stream pb<span class="token punctuation">.</span>RouteGuide_RecordRouteServer<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pointCount<span class="token punctuation">,</span> featureCount<span class="token punctuation">,</span> distance <span class="token builtin">int32</span>
    <span class="token keyword">var</span> lastPoint <span class="token operator">*</span>pb<span class="token punctuation">.</span>Point
    startTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        point<span class="token punctuation">,</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
            endTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> stream<span class="token punctuation">.</span><span class="token function">SendAndClose</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pb<span class="token punctuation">.</span>RouteSummary<span class="token punctuation">{</span>
                PointCount<span class="token punctuation">:</span> pointCount<span class="token punctuation">,</span>
                FeatureCount<span class="token punctuation">:</span> featureCount<span class="token punctuation">,</span>
                Distance<span class="token punctuation">:</span> distance<span class="token punctuation">,</span>
                ElapsedTime<span class="token punctuation">:</span> <span class="token function">int32</span><span class="token punctuation">(</span>endTime<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>startTime<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Seconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> err
        <span class="token punctuation">}</span>
        pointCount<span class="token operator">++</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> feature <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>savedFeatures <span class="token punctuation">{</span>
            <span class="token keyword">if</span> proto<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>Location<span class="token punctuation">,</span> point<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                featureCount<span class="token operator">++</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> lastPoint <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            distance <span class="token operator">+=</span> <span class="token function">calcDistance</span><span class="token punctuation">(</span>lastPoint<span class="token punctuation">,</span> point<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        lastPoint <span class="token operator">=</span> point
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>In the method body we use the <code>RouteGuide_RecordRouteServer</code>'s <code>Recv()</code> method to repeatedly read in our client’s requests to a request object (in this case a <code>Point</code>) until there are no more messages: the server needs to check the error returned from <code>Recv()</code> after each call. If this is nil, the stream is still good and it can continue reading; if it is <code>io.EOF</code> the message stream has ended and the server can return its <code>RouteSummary</code>. If it has any other value, we return the error “as is ” so that it’ll be translated to an RPC status by the gRPC layer.</p> <h3 id="_4-5-bidirectional-streaming-rpc"><a href="#_4-5-bidirectional-streaming-rpc" class="header-anchor">#</a> 4.5 Bidirectional streaming RPC</h3> <p>Finally, let’s look at our bidirectional streaming RPC <code>RouteChat()</code>:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>routeGuideServer<span class="token punctuation">)</span> <span class="token function">RouteChat</span><span class="token punctuation">(</span>stream pb<span class="token punctuation">.</span>RouteGuide_RouteChatServer<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        in<span class="token punctuation">,</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> err
        <span class="token punctuation">}</span>
        key <span class="token operator">:=</span> <span class="token function">serialize</span><span class="token punctuation">(</span>in<span class="token punctuation">.</span>Location<span class="token punctuation">)</span>
        <span class="token operator">...</span> <span class="token comment">// look for notes to be sent to client</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> note <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>routeNotes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">;</span>err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> err
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>This time we get a <code>RouteGuide_RouteChatServer</code> stream that, as in our client-side streaming example, can be used to read and write messages. However, this time we return values via our method’s stream while the client is still writing messages to <em>their</em> message stream.</p> <p>The syntax for reading and writing here is very similar to our client-side streaming method, except the server uses the stream’s <code>Send()</code> method rather than <code>SendAndClose()</code> because it’s writing multiple responses. Although each side will always get the other’s messages in the order they were written, both the client and server can read and write in any order -- the streams operate completely independently.</p> <h2 id="_5-starting-the-server"><a href="#_5-starting-the-server" class="header-anchor">#</a> 5. Starting the server</h2> <p>Once we have implemented all our methods, we also need to start up a gRPC server so that clients can actually use our service. The following snippet show how we do this for our <code>RouteGuide</code> service:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
lis<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;localhost:%d&quot;</span><span class="token punctuation">,</span><span class="token operator">*</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;failed to listen: %v&quot;</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> opts <span class="token punctuation">[</span><span class="token punctuation">]</span>grpc<span class="token punctuation">.</span>ServerOption
<span class="token operator">...</span>
grpcServer <span class="token operator">:=</span> grpc<span class="token punctuation">.</span><span class="token function">NewServer</span><span class="token punctuation">(</span>opts<span class="token operator">...</span><span class="token punctuation">)</span>
pb<span class="token punctuation">.</span><span class="token function">RegisterRouteGuideServer</span><span class="token punctuation">(</span>grpcServer<span class="token punctuation">,</span> <span class="token function">newServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
grpcServer<span class="token punctuation">.</span><span class="token function">Serve</span><span class="token punctuation">(</span>lis<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>To build and start a server, we:</p> <ol><li>Specify the port we want to use to listen for client requests using:
<code>lis, err := net.Listen(...)</code></li> <li>Create an instance of the gRPC server using
<code>grpc.NewServer()</code>.</li> <li>Register our service implementation with the gRPC server.</li> <li>Call <code>Serve()</code> on the server with our port details to do a blocking wait until the process is killed or <code>Stop()</code> is called.</li></ol> <h2 id="_6-creating-the-client"><a href="#_6-creating-the-client" class="header-anchor">#</a> 6. Creating the client</h2> <h3 id="_6-1-creating-a-stub"><a href="#_6-1-creating-a-stub" class="header-anchor">#</a> 6.1 Creating a stub</h3> <p>To call service methods, we first need to create a gRPC <em>channel</em> to communicate with the server. We create this by passing the server address and port number to <code>grpc.Dial()</code> as follows:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> opts <span class="token punctuation">[</span><span class="token punctuation">]</span>grpc<span class="token punctuation">.</span>DialOption
<span class="token operator">...</span>
conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> grpc<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token operator">*</span>serverAddr<span class="token punctuation">,</span> opts<span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>You can use <code>DialOptions</code> to set the auth credentials (for example, TLS, GCE credentials, or JWT credentials) in <code>grpc.Dial</code> when a service requires them. The <code>RouteGuide</code> service doesn’t require any credentials.</p> <p>Once the gRPC <em>channel</em> is setup, we need a client stub to perform RPCs. We get it using the <code>NewRouteGuideClient</code> method provided by the <code>pb</code> package generated from the example <code>.proto</code> file:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>client <span class="token operator">:=</span> pb<span class="token punctuation">.</span><span class="token function">NewRouteGuideClient</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_6-2-calling-service-methods"><a href="#_6-2-calling-service-methods" class="header-anchor">#</a> 6.2 Calling service methods</h3> <p>Now let’s look at how we call our service methods. Note that in gRPC-Go, RPCs operate in a blocking/synchronous mode, which means that the RPCd call waits for the server to respond, and will either return a response or an error.</p> <h3 id="_6-3-simple-rpc"><a href="#_6-3-simple-rpc" class="header-anchor">#</a> 6.3 Simple RPC</h3> <p>Calling the simple RPC <code>GetFeature</code> is nearly as straightforward as calling a local method.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>feature<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">GetFeature</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>pb<span class="token punctuation">.</span>Point<span class="token punctuation">{</span><span class="token number">409146138</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">746188906</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>As you can see, we call the method on the stub we got earlier. In our method parameters we create and populate a request protocol buffer object (in our case <code>Point</code>). We also pass a <code>context.Context</code> Object which lets us change our RPC’s behavior if necessary, such as time-out/cancel an RPC in flight. If the call doesn’t return an error, then we can read the response information from the server from the first return value.</p> <h3 id="_6-4-server-side-streaming-rpc"><a href="#_6-4-server-side-streaming-rpc" class="header-anchor">#</a> 6.4 Server-side streaming RPC</h3> <p>Here’s where we call the server-side streaming method <code>ListFeatures</code>, which returns a stream of geographical <code>Feature</code>s. If you’ve already read Creating the server some of this may look very familiar - streaming RPCs are implemented in a similar way on both side.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>rect <span class="token operator">:=</span> <span class="token operator">&amp;</span>pb<span class="token punctuation">.</span>Rectangle<span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span> <span class="token comment">// initialize a pb.Rectangle</span>
stream<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">ListFeatures</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rect<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">{</span>
    feature<span class="token punctuation">,</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">==</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
        <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;%v.ListFeatures(_) = _, %v&quot;</span><span class="token punctuation">,</span>client<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>As in the simple RPC, we pass the method a context  and a request. However, instead of getting a response object back, we get back an instance of <code>RouteGuide_ListFeaturesClient</code>. The Client can use the <code>RouteGuide_ListFeaturesClient</code> stream to read the server’s response.</p> <p>We use the <code>RouteGuide_ListFeaturesClient</code>'s' <code>Recv()</code> method to repeatedly read in the server’s response to a response protocol buffer object (in this case a <code>Feature</code>) until there are no more messages: the client needs to check the error <code>err</code> returned from <code>Recv()</code> after each call; if it’s <code>io.EOF</code> then the message stream has ended; otherwise there must be an RPC error, which is passed over through <code>err</code>.</p> <h3 id="_6-5-client-side-streaming-rpc"><a href="#_6-5-client-side-streaming-rpc" class="header-anchor">#</a> 6.5 Client-side streaming RPC</h3> <p>The client-side streaming method <code>RecordRoute</code> is similar to the server-side method, except that we only pass the method a context and get a <code>RouteGuide_RecordRouteClient</code> stream back, which we can use to both write and read messages.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Create a random number of random points</span>
r <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">NewSource</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UnixNano</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pointCount <span class="token operator">:=</span> <span class="token function">int</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">Int31n</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token comment">// Traverse at least two points</span>
<span class="token keyword">var</span> points <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>pb<span class="token punctuation">.</span>Point
<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointCount<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
    points <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>points<span class="token punctuation">,</span><span class="token function">randomPoint</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Traversing %d points.&quot;</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span>
stream<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">RecordRoute</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;%v.RecordRoute(_) = _, %v&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>client<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> point <span class="token operator">:=</span> <span class="token keyword">range</span> points <span class="token punctuation">{</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;%v.Send(%v) = %v&quot;</span><span class="token punctuation">,</span>stream<span class="token punctuation">,</span> point<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
reply<span class="token punctuation">,</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">CloseAndRecv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;%v.CloseAndRecv() got error %v, want %v&quot;</span><span class="token punctuation">,</span>stream<span class="token punctuation">,</span> err<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Route summary: %v&quot;</span><span class="token punctuation">,</span>reply<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>The <code>RouteGuide_RecordRouteClient</code> has a <code>Send()</code> method that we can use to send requests to the server. Once we have finished writing our client’s requests to the stream using <code>Send()</code>, we need to call <code>CloseAndRecv()</code> on the stream to let gRPC know that we’ve finished writing and are expecting to receive a response. We get our RPC status from the <code>err</code> returned from <code>CloseAndRecv()</code> . if the status is <code>nil</code>, then the first return value from <code>CloseAndRecv()</code> will be a valid server response.</p> <h3 id="_6-6-bidirectional-streaming-rpc"><a href="#_6-6-bidirectional-streaming-rpc" class="header-anchor">#</a> 6.6 Bidirectional streaming RPC</h3> <p>Finally, let’s look at our bidirectional streaming RPC <code>RouteChat()</code>. As in the case of <code>RecordRoute</code>, we only pass the method a context object and get back a stream that we can use to both write and read messages. However, this time we return values via our method’s stream while the server is still writing messages to their message stream.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>stream<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">RouteChat</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
waitc <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        in<span class="token punctuation">,</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> io<span class="token punctuation">.</span>EOF <span class="token punctuation">{</span>
            <span class="token comment">// read done</span>
            <span class="token function">close</span><span class="token punctuation">(</span>waitc<span class="token punctuation">)</span>
            <span class="token keyword">return</span> 
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to receive a note: %v&quot;</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Got message %s at point(%d,%d)&quot;</span><span class="token punctuation">,</span>in<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> in<span class="token punctuation">.</span>Location<span class="token punctuation">.</span>Latitude<span class="token punctuation">,</span> in<span class="token punctuation">.</span>Location<span class="token punctuation">.</span>Longitude<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> note <span class="token operator">:=</span> <span class="token keyword">range</span> notes <span class="token punctuation">{</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> stream<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to send a note: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
stream<span class="token punctuation">.</span><span class="token function">CloseSend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;-</span> waitc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>The syntax for reading and writing here is very similar to client-side streaming method, except we use the stream’s <code>CloseSend()</code> method once we’ve finished our call. Although each side will always get the other’s messages in the order they were written, both the client and server can read and write in any order -- the streams operate completely independently.</p> <h2 id="_7-try-it-out"><a href="#_7-try-it-out" class="header-anchor">#</a> 7. Try it out</h2> <ol><li><p>Run the server:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ go run server/server.go -json_db_file <span class="token punctuation">..</span>/testdata/route_guide_db.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Run the client:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ go run client/client.go
<span class="token punctuation">..</span>.
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Traversing <span class="token number">34</span> points.
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Route summary: point_count:34
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message First message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Second message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Third message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message First message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Fourth message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Second message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Fifth message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Third message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token number">2022</span>/01/05 <span class="token number">17</span>:28:59 Got message Sixth message at point <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ol> <h2 id="reference"><a href="#reference" class="header-anchor">#</a> Reference</h2> <ol><li><a href="https://grpc.io/docs/languages/go/basics/" target="_blank" rel="noopener noreferrer">Basic Tutorial<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> gRPC docs</li></ol></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2022/1/7 03:01:26</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/zh/rpc/gRPC/quick_start.html" class="prev">
            Quick Start
          </a></span> <span class="next"><a href="/zh/rpc/gRPC/atls.html">
            ATLS
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-898d6c54><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_1-why-use-grpc" class="sidebar-link reco-side-_1-why-use-grpc" data-v-898d6c54>1. Why use gRPC</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_2-defining-the-service" class="sidebar-link reco-side-_2-defining-the-service" data-v-898d6c54>2. Defining the service</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_3-generating-client-and-server-code" class="sidebar-link reco-side-_3-generating-client-and-server-code" data-v-898d6c54>3. Generating client and server code</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_4-creating-the-server" class="sidebar-link reco-side-_4-creating-the-server" data-v-898d6c54>4. Creating the server</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_4-1-implementing-routeguide" class="sidebar-link reco-side-_4-1-implementing-routeguide" data-v-898d6c54>4.1 Implementing RouteGuide</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_4-2-simple-rpc" class="sidebar-link reco-side-_4-2-simple-rpc" data-v-898d6c54>4.2 Simple RPC</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_4-3-server-side-streaming-rpc" class="sidebar-link reco-side-_4-3-server-side-streaming-rpc" data-v-898d6c54>4.3 Server-side streaming RPC</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_4-4-client-side-streaming-rpc" class="sidebar-link reco-side-_4-4-client-side-streaming-rpc" data-v-898d6c54>4.4 Client-side streaming RPC</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_4-5-bidirectional-streaming-rpc" class="sidebar-link reco-side-_4-5-bidirectional-streaming-rpc" data-v-898d6c54>4.5 Bidirectional streaming RPC</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_5-starting-the-server" class="sidebar-link reco-side-_5-starting-the-server" data-v-898d6c54>5. Starting the server</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-creating-the-client" class="sidebar-link reco-side-_6-creating-the-client" data-v-898d6c54>6. Creating the client</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-1-creating-a-stub" class="sidebar-link reco-side-_6-1-creating-a-stub" data-v-898d6c54>6.1 Creating a stub</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-2-calling-service-methods" class="sidebar-link reco-side-_6-2-calling-service-methods" data-v-898d6c54>6.2 Calling service methods</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-3-simple-rpc" class="sidebar-link reco-side-_6-3-simple-rpc" data-v-898d6c54>6.3 Simple RPC</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-4-server-side-streaming-rpc" class="sidebar-link reco-side-_6-4-server-side-streaming-rpc" data-v-898d6c54>6.4 Server-side streaming RPC</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-5-client-side-streaming-rpc" class="sidebar-link reco-side-_6-5-client-side-streaming-rpc" data-v-898d6c54>6.5 Client-side streaming RPC</a></li><li class="level-3" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_6-6-bidirectional-streaming-rpc" class="sidebar-link reco-side-_6-6-bidirectional-streaming-rpc" data-v-898d6c54>6.6 Bidirectional streaming RPC</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#_7-try-it-out" class="sidebar-link reco-side-_7-try-it-out" data-v-898d6c54>7. Try it out</a></li><li class="level-2" data-v-898d6c54><a href="/zh/rpc/gRPC/basic_tutorial.html#reference" class="sidebar-link reco-side-reference" data-v-898d6c54>Reference</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><div id="goTop" class="hide-cat" data-v-bf92849a></div></div></div>
    <script src="/assets/js/app.35ae0727.js" defer></script><script src="/assets/js/6.af237152.js" defer></script><script src="/assets/js/1.44a00389.js" defer></script><script src="/assets/js/100.e98c1a94.js" defer></script>
  </body>
</html>
