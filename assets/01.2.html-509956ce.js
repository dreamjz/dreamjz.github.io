const n=JSON.parse('{"key":"v-08b1323d","path":"/note/golang/gorm/01.2.html","title":"CRUD","lang":"zh-CN","frontmatter":{"title":"CRUD","date":"2021-11-27T00:00:00.000Z","category":["golang"],"tag":["gorm"],"timeline":true},"headers":[{"level":2,"title":"5. CRUD","slug":"_5-crud","link":"#_5-crud","children":[{"level":3,"title":"5.1 Create","slug":"_5-1-create","link":"#_5-1-create","children":[]},{"level":3,"title":"5.2 Read","slug":"_5-2-read","link":"#_5-2-read","children":[]},{"level":3,"title":"5.3 Update","slug":"_5-3-update","link":"#_5-3-update","children":[]},{"level":3,"title":"5.4 Delete","slug":"_5-4-delete","link":"#_5-4-delete","children":[]}]},{"level":2,"title":"6. Raw SQL and SQL Builder","slug":"_6-raw-sql-and-sql-builder","link":"#_6-raw-sql-and-sql-builder","children":[{"level":3,"title":"6.1 Raw SQL","slug":"_6-1-raw-sql","link":"#_6-1-raw-sql","children":[]},{"level":3,"title":"6.2 Named Argument","slug":"_6-2-named-argument","link":"#_6-2-named-argument","children":[]},{"level":3,"title":"6.3 DryRun Mode","slug":"_6-3-dryrun-mode","link":"#_6-3-dryrun-mode","children":[]},{"level":3,"title":"6.4 ToSQL","slug":"_6-4-tosql","link":"#_6-4-tosql","children":[]},{"level":3,"title":"6.5 Row and Rows","slug":"_6-5-row-and-rows","link":"#_6-5-row-and-rows","children":[]},{"level":3,"title":"6.6 Clauses","slug":"_6-6-clauses","link":"#_6-6-clauses","children":[]},{"level":3,"title":"6.7 Clause Options","slug":"_6-7-clause-options","link":"#_6-7-clause-options","children":[]},{"level":3,"title":"6.8 StatementModifier","slug":"_6-8-statementmodifier","link":"#_6-8-statementmodifier","children":[]}]},{"level":2,"title":"Reference","slug":"reference","link":"#reference","children":[]}],"readingTime":{"minutes":28.48,"words":8544},"filePathRelative":"note/golang/gorm/01.2.md","localizedDate":"2021年11月27日","excerpt":"<h2> 5. CRUD</h2>\\n<h3> 5.1 Create</h3>\\n<h4> 5.1.1 创建记录</h4>\\n<div class=\\"language-go line-numbers-mode\\" data-ext=\\"go\\"><pre class=\\"language-go\\"><code><span class=\\"token keyword\\">package</span> main\\n\\n<span class=\\"token keyword\\">import</span> <span class=\\"token punctuation\\">(</span>\\n\\t<span class=\\"token string\\">\\"fmt\\"</span>\\n\\t<span class=\\"token string\\">\\"log\\"</span>\\n\\t<span class=\\"token string\\">\\"time\\"</span>\\n\\n\\t<span class=\\"token string\\">\\"gorm.io/gorm/logger\\"</span>\\n\\n\\t<span class=\\"token string\\">\\"gorm.io/driver/sqlite\\"</span>\\n\\t<span class=\\"token string\\">\\"gorm.io/gorm\\"</span>\\n<span class=\\"token punctuation\\">)</span>\\n\\n<span class=\\"token keyword\\">type</span> User <span class=\\"token keyword\\">struct</span> <span class=\\"token punctuation\\">{</span>\\n\\tgorm<span class=\\"token punctuation\\">.</span>Model\\n\\tName     <span class=\\"token builtin\\">string</span>\\n\\tAge      <span class=\\"token builtin\\">int</span>\\n\\tBirthday time<span class=\\"token punctuation\\">.</span>Time\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token keyword\\">const</span> <span class=\\"token punctuation\\">(</span>\\n\\ttimeFormat <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\\"2006-01-02 15:04:05.000\\"</span>\\n<span class=\\"token punctuation\\">)</span>\\n\\n<span class=\\"token keyword\\">func</span> <span class=\\"token punctuation\\">(</span>u User<span class=\\"token punctuation\\">)</span> <span class=\\"token function\\">String</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token builtin\\">string</span> <span class=\\"token punctuation\\">{</span>\\n\\t<span class=\\"token keyword\\">return</span> fmt<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Sprintf</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"ID: %d, Name: %s, Age: %d, Birthday: %s\\\\nCreatedAy: %s, UpadtedAt: %s, DeletedAt: %s\\"</span><span class=\\"token punctuation\\">,</span>\\n\\t\\tu<span class=\\"token punctuation\\">.</span>ID<span class=\\"token punctuation\\">,</span> u<span class=\\"token punctuation\\">.</span>Name<span class=\\"token punctuation\\">,</span> u<span class=\\"token punctuation\\">.</span>Age<span class=\\"token punctuation\\">,</span> u<span class=\\"token punctuation\\">.</span>Birthday<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Format</span><span class=\\"token punctuation\\">(</span>timeFormat<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span> u<span class=\\"token punctuation\\">.</span>CreatedAt<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Format</span><span class=\\"token punctuation\\">(</span>timeFormat<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span> u<span class=\\"token punctuation\\">.</span>UpdatedAt<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Format</span><span class=\\"token punctuation\\">(</span>timeFormat<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n\\t\\tu<span class=\\"token punctuation\\">.</span>DeletedAt<span class=\\"token punctuation\\">.</span>Time<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Format</span><span class=\\"token punctuation\\">(</span>timeFormat<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token keyword\\">func</span> <span class=\\"token function\\">main</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n\\tdb<span class=\\"token punctuation\\">,</span> err <span class=\\"token operator\\">:=</span> gorm<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Open</span><span class=\\"token punctuation\\">(</span>sqlite<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Open</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"create.db\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span> <span class=\\"token operator\\">&amp;</span>gorm<span class=\\"token punctuation\\">.</span>Config<span class=\\"token punctuation\\">{</span>\\n\\t\\tLogger<span class=\\"token punctuation\\">:</span> logger<span class=\\"token punctuation\\">.</span>Default<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">LogMode</span><span class=\\"token punctuation\\">(</span>logger<span class=\\"token punctuation\\">.</span>Info<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n\\t<span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n\\t<span class=\\"token keyword\\">if</span> err <span class=\\"token operator\\">!=</span> <span class=\\"token boolean\\">nil</span> <span class=\\"token punctuation\\">{</span>\\n\\t\\t<span class=\\"token function\\">panic</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"failed to connect database\\"</span><span class=\\"token punctuation\\">)</span>\\n\\t<span class=\\"token punctuation\\">}</span>\\n\\tsqlDB<span class=\\"token punctuation\\">,</span> <span class=\\"token boolean\\">_</span> <span class=\\"token operator\\">:=</span> db<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">DB</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>\\n\\t<span class=\\"token keyword\\">defer</span> sqlDB<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Close</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>\\n\\tdb<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">AutoMigrate</span><span class=\\"token punctuation\\">(</span><span class=\\"token operator\\">&amp;</span>User<span class=\\"token punctuation\\">{</span><span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n\\n\\tuser <span class=\\"token operator\\">:=</span> User<span class=\\"token punctuation\\">{</span>Name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"kesa\\"</span><span class=\\"token punctuation\\">,</span> Age<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">18</span><span class=\\"token punctuation\\">,</span> Birthday<span class=\\"token punctuation\\">:</span> time<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Now</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">}</span>\\n\\tresult <span class=\\"token operator\\">:=</span> db<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Create</span><span class=\\"token punctuation\\">(</span><span class=\\"token operator\\">&amp;</span>user<span class=\\"token punctuation\\">)</span>\\n\\tlog<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Printf</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"New record ID: %d\\"</span><span class=\\"token punctuation\\">,</span> user<span class=\\"token punctuation\\">.</span>ID<span class=\\"token punctuation\\">)</span>\\n\\tlog<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Printf</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"Error %v\\"</span><span class=\\"token punctuation\\">,</span> result<span class=\\"token punctuation\\">.</span>Error<span class=\\"token punctuation\\">)</span>\\n\\tlog<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Printf</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"Rows affected: %d\\"</span><span class=\\"token punctuation\\">,</span> result<span class=\\"token punctuation\\">.</span>RowsAffected<span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}');export{n as data};
