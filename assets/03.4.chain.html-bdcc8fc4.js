const n=JSON.parse('{"key":"v-732e1f85","path":"/reading/golang/7-days-golang/03-GeeORM/03.4.chain.html","title":"4. 链式操作","lang":"zh-CN","frontmatter":{"title":"4. 链式操作","date":"2023-10-11T00:00:00.000Z","category":["golang"],"article":false},"headers":[{"level":2,"title":"1. 实现 Update、Delete和Count","slug":"_1-实现-update、delete和count","link":"#_1-实现-update、delete和count","children":[{"level":3,"title":"1.1 子句生成","slug":"_1-1-子句生成","link":"#_1-1-子句生成","children":[]},{"level":3,"title":"1.2 Update","slug":"_1-2-update","link":"#_1-2-update","children":[]},{"level":3,"title":"1.3 Delete","slug":"_1-3-delete","link":"#_1-3-delete","children":[]},{"level":3,"title":"1.4 Count","slug":"_1-4-count","link":"#_1-4-count","children":[]}]},{"level":2,"title":"2. 链式调用(chain)","slug":"_2-链式调用-chain","link":"#_2-链式调用-chain","children":[]},{"level":2,"title":"3. First 只返回一条记录","slug":"_3-first-只返回一条记录","link":"#_3-first-只返回一条记录","children":[]},{"level":2,"title":"4. 单元测试","slug":"_4-单元测试","link":"#_4-单元测试","children":[]},{"level":2,"title":"Reference","slug":"reference","link":"#reference","children":[]}],"git":{"updatedTime":1699943615000},"readingTime":{"minutes":2.53,"words":758},"filePathRelative":"reading/golang/7-days-golang/03-GeeORM/03.4.chain.md","localizedDate":"2023年10月11日","excerpt":"<p><a href=\\"https://github.com/dreamjz/golang-notes/tree/main/books/7-days-golang/GeeORM/day4-chain\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">day4-chain</a></p>\\n<h2> 1. 实现 Update、Delete和Count</h2>\\n<h3> 1.1 子句生成</h3>\\n<p><code>clause/clause.go, generator.go</code>新增更新，删除和计数功能。</p>\\n<div class=\\"language-go line-numbers-mode\\" data-ext=\\"go\\"><pre class=\\"language-go\\"><code><span class=\\"token keyword\\">func</span> <span class=\\"token function\\">_update</span><span class=\\"token punctuation\\">(</span>vals <span class=\\"token operator\\">...</span>any<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">(</span><span class=\\"token builtin\\">string</span><span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span>any<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n\\ttableName <span class=\\"token operator\\">:=</span> vals<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">]</span>\\n\\tm <span class=\\"token operator\\">:=</span> vals<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">1</span><span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">.</span><span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">map</span><span class=\\"token punctuation\\">[</span><span class=\\"token builtin\\">string</span><span class=\\"token punctuation\\">]</span>any<span class=\\"token punctuation\\">)</span>\\n\\t<span class=\\"token keyword\\">var</span> <span class=\\"token punctuation\\">(</span>\\n\\t\\tkeys <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span><span class=\\"token builtin\\">string</span>\\n\\t\\tvars <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span>any\\n\\t<span class=\\"token punctuation\\">)</span>\\n\\t<span class=\\"token keyword\\">for</span> k<span class=\\"token punctuation\\">,</span> v <span class=\\"token operator\\">:=</span> <span class=\\"token keyword\\">range</span> m <span class=\\"token punctuation\\">{</span>\\n\\t\\tkeys <span class=\\"token operator\\">=</span> <span class=\\"token function\\">append</span><span class=\\"token punctuation\\">(</span>keys<span class=\\"token punctuation\\">,</span> k<span class=\\"token operator\\">+</span><span class=\\"token string\\">\\" = ?\\"</span><span class=\\"token punctuation\\">)</span>\\n\\t\\tvars <span class=\\"token operator\\">=</span> <span class=\\"token function\\">append</span><span class=\\"token punctuation\\">(</span>vars<span class=\\"token punctuation\\">,</span> v<span class=\\"token punctuation\\">)</span>\\n\\t<span class=\\"token punctuation\\">}</span>\\n\\t<span class=\\"token keyword\\">return</span> fmt<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Sprintf</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"UPDATE %s SET %s\\"</span><span class=\\"token punctuation\\">,</span> tableName<span class=\\"token punctuation\\">,</span> strings<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Join</span><span class=\\"token punctuation\\">(</span>keys<span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\\", \\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span> vars\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token keyword\\">func</span> <span class=\\"token function\\">_delete</span><span class=\\"token punctuation\\">(</span>vals <span class=\\"token operator\\">...</span>any<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">(</span><span class=\\"token builtin\\">string</span><span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span>any<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n\\t<span class=\\"token keyword\\">return</span> fmt<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">Sprintf</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"DELETE FROM %s\\"</span><span class=\\"token punctuation\\">,</span> vals<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span>any<span class=\\"token punctuation\\">{</span><span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token keyword\\">func</span> <span class=\\"token function\\">_count</span><span class=\\"token punctuation\\">(</span>vals <span class=\\"token operator\\">...</span>any<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">(</span><span class=\\"token builtin\\">string</span><span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span>any<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n\\t<span class=\\"token keyword\\">return</span> <span class=\\"token function\\">_select</span><span class=\\"token punctuation\\">(</span>vals<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">[</span><span class=\\"token punctuation\\">]</span><span class=\\"token builtin\\">string</span><span class=\\"token punctuation\\">{</span><span class=\\"token string\\">\\"count(*)\\"</span><span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}');export{n as data};
